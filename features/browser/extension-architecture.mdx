---
title: "Browser Extension Architecture"
description: "How the Chrome Extension communicates with the Python CLI for browser automation"
icon: "puzzle-piece"
---

# Browser Extension Architecture

The PraisonAI browser automation uses a 3-layer architecture for AI-powered browser control.

## Overview

```mermaid
sequenceDiagram
    participant CLI as Python CLI
    participant Bridge as Bridge Server
    participant Ext as Chrome Extension

    Note over CLI: User runs: praisonai browser launch
    
    CLI->>Bridge: connect to ws://localhost:8765/ws
    Bridge-->>CLI: {"type":"status","status":"connected"}
    
    CLI->>Bridge: {"type":"start_session","goal":"..."}
    
    Note over Bridge: Creates BrowserAgent<br/>Sets up session
    
    Bridge-->>CLI: {"type":"status","status":"running"}
    Bridge->>Ext: {"type":"start_automation","goal":"..."}
    
    Note over Ext: Receives goal<br/>Attaches CDP to tab<br/>Captures screenshot<br/>Gets clickable elements
    
    Ext->>Bridge: {"type":"observation",...}
    
    Note over Bridge: BrowserAgent.aprocess_observation()<br/>Calls LLM for decision<br/>Returns action
    
    Bridge-->>Ext: {"type":"action","action":"search",...}
    Bridge-->>CLI: {"type":"action",...} (broadcast)
    
    Note over Ext: Executes action<br/>Sends next observation
```

## Components

### 1. Python CLI
Launches Chrome and initiates automation sessions.

```bash
# Simple usage
praisonai browser launch "go to google and search for AI"

# Force extension mode
praisonai browser launch "go to google" --engine extension
```

### 2. Bridge Server
FastAPI WebSocket server that routes messages and hosts the BrowserAgent.

```python
from praisonai.browser import BrowserServer

server = BrowserServer(port=8765)
server.start()  # Starts on http://localhost:8765
```

### 3. Chrome Extension
Manifest V3 extension with background service worker.

- **CDP Debugger**: Controls page via Chrome DevTools Protocol
- **Screenshot Capture**: Sends JPEG images to LLM for vision
- **Element Detection**: Finds clickable elements for agent

## Message Types

| Type | Direction | Description |
|------|-----------|-------------|
| `start_session` | CLI â†’ Server | Start new automation |
| `observation` | Ext â†’ Server | Page state snapshot |
| `action` | Server â†’ Ext | Next action to execute |
| `status` | Server â†’ Both | Session status updates |
| `stop_session` | Any â†’ Server | End session |

## Troubleshooting

### Extension Not Connecting

```bash
# Check if bridge server is running
curl http://localhost:8765/health

# Kill stale processes
pkill -f "praisonai_chrome_"
```

### Debug Mode

```bash
praisonai browser launch "test" --debug
```

This enables verbose logging and saves screenshots to `~/.praisonai/browser_screenshots/`.

## Performance Profiling

Track timing breakdown for each automation step:

```bash
# Basic profiling with timing summary
praisonai browser launch "search for AI" --engine cdp --profile

# Deep profiling with cProfile trace
praisonai browser launch "search for AI" --engine cdp --deep-profile
```

### Sample Output

```
ðŸ“Š Performance Profile
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total Time: 24.2s | Steps: 3 | Avg: 8.1s/step

Step |    LLM | Screen | Action | Verify | Stable |  Total
   0 |   2.4s |   0.0s |   1.0s |   0.0s |   0.0s |   3.5s
   1 |   2.2s |   0.0s |   0.2s |   0.0s |   0.0s |   2.5s

Bottlenecks: LLM 51% | Verify 0% | Stable 0%
```

### Timing Breakdown

| Metric | Description |
|--------|-------------|
| LLM | Time spent waiting for LLM decision |
| Screen | Screenshot capture time |
| Action | CDP action execution time |
| Verify | Action verification time |
| Stable | Page stability wait time |
