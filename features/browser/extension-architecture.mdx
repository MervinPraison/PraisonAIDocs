---
title: "Browser Extension Architecture"
description: "How the Chrome Extension communicates with the Python CLI for browser automation"
icon: "puzzle-piece"
---

# Browser Extension Architecture

The PraisonAI browser automation uses a 3-layer architecture for AI-powered browser control.

## Communication Flow

```
Python CLI â”€â”€â–º Bridge Server â—„â”€â”€â–º Chrome Extension
     â”‚              â”‚                    â”‚
     â”‚              â”‚                    â”‚
 start_session  observation/action      CDP
```

1. **CLI** sends `start_session` with goal
2. **Bridge Server** routes to **Extension**
3. **Extension** captures page state (screenshot, elements)
4. **Extension** sends `observation` to **Bridge**
5. **Bridge** processes with BrowserAgent (LLM decision)
6. **Bridge** returns `action` to **Extension**
7. **Extension** executes action via CDP
8. Loop continues until goal complete

## Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Python CLI                               â”‚
â”‚  praisonai browser launch "goal"                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ WebSocket
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Bridge Server (FastAPI)                     â”‚
â”‚  - Routes messages CLI â†” Extension                          â”‚
â”‚  - Hosts BrowserAgent for LLM decisions                     â”‚
â”‚  - WebSocket endpoint: ws://localhost:8765/ws               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ WebSocket
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Chrome Extension                              â”‚
â”‚  - Background service worker                                â”‚
â”‚  - CDP debugger for page control                            â”‚
â”‚  - Captures screenshots, clickable elements                 â”‚
â”‚  - Executes click/type/scroll actions                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Running the Browser Agent

```bash
# Simple usage (auto-selects engine)
praisonai browser launch "go to google and search for AI"

# Force extension mode
praisonai browser launch "go to google" --engine extension

# Force CDP mode (no extension required)
praisonai browser launch "go to google" --engine cdp

# Debug mode
praisonai browser launch "test" --debug
```

## Message Types

| Type | Direction | Description |
|------|-----------|-------------|
| `start_session` | CLI â†’ Server | Start new automation |
| `observation` | Ext â†’ Server | Page state snapshot |
| `action` | Server â†’ Ext | Next action to execute |
| `status` | Server â†’ Both | Session status updates |
| `stop_session` | Any â†’ Server | End session |

## Troubleshooting

### Extension Not Connecting

If you see "Extension did not connect after 15s":

1. **Check extension console**:
   - Go to `chrome://extensions/`
   - Find "PraisonAI Browser Agent"
   - Click "service worker" link
   - Look for errors

2. **Kill stale Chrome processes**:
   ```bash
   pkill -f "Google Chrome"
   ```

3. **Rebuild extension**:
   ```bash
   cd /path/to/praisonai-chrome-extension
   npm run build
   ```

4. **Check bridge server**:
   ```bash
   curl http://localhost:8765/health
   ```

### No Observations Sent

If session starts but times out:
- Check extension console for `[PraisonAI] onStartAutomation FATAL ERROR`
- CDP debugger may fail to attach
- Page may be a chrome:// URL (unsupported)

### Debug Mode

```bash
praisonai browser launch "test" --debug
```

This enables verbose logging and saves screenshots to `~/.praisonai/browser_screenshots/`.

## Performance Profiling

Track timing breakdown for each automation step:

```bash
# Basic profiling with timing summary
praisonai browser launch "search for AI" --engine cdp --profile

# Deep profiling with cProfile trace
praisonai browser launch "search for AI" --engine cdp --deep-profile
```

### Sample Output

```
ğŸ“Š Performance Profile
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total Time: 24.2s | Steps: 3 | Avg: 8.1s/step

Step |    LLM | Screen | Action | Verify | Stable |  Total
   0 |   2.4s |   0.0s |   1.0s |   0.0s |   0.0s |   3.5s
   1 |   2.2s |   0.0s |   0.2s |   0.0s |   0.0s |   2.5s

Bottlenecks: LLM 51% | Verify 0% | Stable 0%
```

### Timing Breakdown

| Metric | Description |
|--------|-------------|
| LLM | Time spent waiting for LLM decision |
| Screen | Screenshot capture time |
| Action | CDP action execution time |
| Verify | Action verification time |
| Stable | Page stability wait time |
