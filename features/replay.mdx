---
title: "Context Replay"
description: "Debug and replay agent execution traces for comprehensive workflow analysis"
icon: "rotate-left"
---

## Overview

Context Replay allows you to capture, save, and replay the full execution trace of your agent workflows. This is invaluable for debugging, auditing, and understanding how your agents process tasks.

## Quick Start

### Capture a Trace

Add `--save` to any execution command to capture a replay trace:

```bash
# Workflow execution
praisonai workflow run workflow.yaml --save

# Agents file execution
praisonai agents.yaml --save

# Recipe execution
praisonai recipe run my-recipe --save
```

### List Available Traces

```bash
praisonai replay list
```

Output:
```
                 Available Context Traces                 
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ Session ID        ┃ Events ┃ Size   ┃ Modified         ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ run-4fd4e2426ab9  │ 6      │ 2.7 KB │ 2026-01-22 13:05 │
│ run-e0b117974e6f  │ 10     │ 4.8 KB │ 2026-01-22 13:06 │
└───────────────────┴────────┴────────┴──────────────────┘
```

### View a Trace

```bash
# Basic view
praisonai replay context <session_id> --dump

# Full content (no truncation)
praisonai replay context <session_id> --dump --full

# JSON output
praisonai replay context <session_id> --json
```

## Event Types

Context Replay captures the following event types:

| Event Type | Description |
|------------|-------------|
| `SESSION_START` | Workflow/agent execution begins |
| `SESSION_END` | Workflow/agent execution completes |
| `AGENT_START` | Individual agent begins processing |
| `AGENT_END` | Individual agent completes |
| `LLM_REQUEST` | Request sent to LLM (includes full messages) |
| `LLM_RESPONSE` | Response received from LLM |
| `TOOL_CALL_START` | Tool execution begins |
| `TOOL_CALL_END` | Tool execution completes |

## Parallel Execution Tracking

For parallel workflows, each branch is tracked with a unique `branch_id`:

```json
{
  "event_type": "agent_start",
  "agent_name": "analyst",
  "branch_id": "parallel_0"
}
```

This allows you to trace which events belong to which parallel execution branch.

## CLI Reference

### `praisonai replay list`

List all available replay traces.

```bash
praisonai replay list
```

### `praisonai replay context`

View a specific replay trace.

```bash
praisonai replay context <session_id> [OPTIONS]
```

**Options:**
- `--dump` - Show events in human-readable format
- `--full` / `-f` - Show full content without truncation
- `--json` - Output as JSON

### `praisonai replay delete`

Delete a replay trace.

```bash
praisonai replay delete <session_id>
```

### `praisonai replay cleanup`

Remove old replay traces.

```bash
praisonai replay cleanup [--days 30]
```

## Example Output

### Basic Dump

```bash
praisonai replay context run-4fd4e2426ab9 --dump
```

```
============================================================
  CONTEXT REPLAY: run-4fd4e2426ab9
  Total Events: 6
============================================================

--------------------------------------------------
[  1] SESSION_START
  workflow: workflow.yaml
  run_id: run-4fd4e2426ab9

--------------------------------------------------
[  2] AGENT_START (greeter)
  role: Friendly Greeter
  goal: Greet the user warmly

--------------------------------------------------
[  3] LLM_REQUEST (greeter)
  model: gpt-4o-mini
  messages: [{'role': 'system', 'content': 'You are a friendly...

--------------------------------------------------
[  4] LLM_RESPONSE (greeter)
  response_tokens: 0
  duration_ms: 2655.09
  response_content: ChatCompletion(id='chatcmpl-...

--------------------------------------------------
[  5] AGENT_END (greeter)

--------------------------------------------------
[  6] SESSION_END

============================================================
  END OF REPLAY (6 events)
============================================================
```

### Full Content View

With `--full`, messages are formatted for readability:

```bash
praisonai replay context run-4fd4e2426ab9 --dump --full
```

```
--------------------------------------------------
[  3] LLM_REQUEST (greeter)
  model: gpt-4o-mini
  messages:
    [1] system:
        You are a friendly assistant who greets users.
        
        Your Role: Friendly Greeter
        Your Goal: Greet the user warmly
    [2] user:
        Say hello to the user with this input: Hello World
```

## Storage Location

Replay traces are stored in:

```
~/.praison/replay/
├── run-4fd4e2426ab9.jsonl
├── run-e0b117974e6f.jsonl
└── ...
```

Each trace is a JSONL file (JSON Lines) where each line is a single event.

## Programmatic Access

You can also access replay data programmatically:

```python
from praisonai.replay import ContextTraceReader

# Read a trace
reader = ContextTraceReader("run-4fd4e2426ab9")
events = reader.read_all()

for event in events:
    print(f"{event.event_type}: {event.agent_name}")
```

## Performance

- **Zero overhead** when `--save` is not used
- Traces are written asynchronously with buffering
- Minimal memory footprint during execution

## Use Cases

1. **Debugging** - Understand why an agent produced unexpected output
2. **Auditing** - Review what data was sent to LLMs
3. **Optimization** - Identify slow steps in workflows
4. **Testing** - Verify agent behavior across runs
5. **Compliance** - Maintain records of AI interactions

## Related

- [Workflows](/features/workflow) - Learn about workflow execution
- [Agents](/agents) - Agent configuration and usage
- [Tools](/tools) - Tool integration and debugging
