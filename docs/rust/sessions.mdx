---
title: "Sessions"
sidebarTitle: "Sessions"
description: "Persist conversation history across executions in the PraisonAI Rust SDK"
icon: "clock-rotate-left"
---

# Sessions

Sessions automatically persist conversation history to disk. When a session ID is provided, history is restored on subsequent runs.

## Quick Start

```rust
use praisonai::{Agent, Session, Result};

#[tokio::main]
async fn main() -> Result<()> {
    // Create a session (auto-persisted)
    let mut session = Session::new("my-session-123");
    
    // Later, load the same session
    let session = Session::load("my-session-123")?;
    
    // Get chat history for agent
    let history = session.get_history(Some(50));
    
    Ok(())
}
```

## Session

The main session manager:

```rust
use praisonai::session::Session;

// Create new or load existing session
let mut session = Session::new("user-alice-123");

// Add messages
session.add_user_message("Hello!")?;
session.add_assistant_message("Hi there!")?;

// Get history for LLM
let history = session.get_history(Some(20));  // Last 20 messages
let all_history = session.get_history(None);  // All messages

// Session info
println!("ID: {}", session.id());
println!("Messages: {}", session.message_count());
println!("Exists on disk: {}", session.exists());

// Manage session
session.set_agent_name("assistant")?;
session.set_user_id("alice")?;
session.save()?;
session.clear()?;
session.delete()?;
```

### Session Methods

| Method | Description |
|--------|-------------|
| `new(id)` | Create or load session |
| `load(id)` | Load existing session |
| `id()` | Get session ID |
| `add_user_message(content)` | Add user message |
| `add_assistant_message(content)` | Add assistant message |
| `add_message(role, content)` | Add message with role |
| `get_history(limit)` | Get LLM-compatible history |
| `messages()` | Get all messages |
| `message_count()` | Get message count |
| `exists()` | Check if saved to disk |
| `save()` | Persist to disk |
| `clear()` | Clear all messages |
| `delete()` | Delete session |

## SessionMessage

Individual messages in a session:

```rust
use praisonai::session::SessionMessage;
use serde_json::json;

// Create messages
let user = SessionMessage::user("Hello");
let assistant = SessionMessage::assistant("Hi there!");
let system = SessionMessage::system("You are helpful");

// With metadata
let msg = SessionMessage::user("Search for X")
    .with_metadata("tool_request", json!(true));

println!("Role: {}", msg.role);
println!("Content: {}", msg.content);
println!("Timestamp: {}", msg.timestamp);

// Convert to LLM Message
let llm_msg = msg.to_message();
```

## SessionData

Complete session representation:

```rust
use praisonai::session::SessionData;

let mut data = SessionData::new("session-123");

// Add messages
data.add_message(SessionMessage::user("Hello"));
data.add_message(SessionMessage::assistant("Hi!"));

// Info
println!("Created: {}", data.created_at);
println!("Updated: {}", data.updated_at);

// Get history with limit
let history = data.get_chat_history(Some(10));

// Clear
data.clear();
```

## Storage Backends

### FileSessionStore (Default)

Persists to `~/.praisonai/sessions/`:

```rust
use praisonai::session::FileSessionStore;

// Default location
let store = FileSessionStore::new();

// Custom directory
let store = FileSessionStore::with_dir("/path/to/sessions");

// With max messages limit
let store = FileSessionStore::new().max_messages(200);
```

### InMemorySessionStore

For testing (no disk persistence):

```rust
use praisonai::session::InMemorySessionStore;

let store = InMemorySessionStore::new();
```

### Custom Store

Implement the `SessionStore` trait:

```rust
use praisonai::session::{SessionStore, SessionData, SessionInfo, Result};

struct RedisSessionStore {
    client: redis::Client,
}

impl SessionStore for RedisSessionStore {
    fn load(&self, session_id: &str) -> Result<SessionData> {
        // Load from Redis
    }
    
    fn save(&self, session: &SessionData) -> Result<()> {
        // Save to Redis
    }
    
    fn exists(&self, session_id: &str) -> bool {
        // Check if exists in Redis
    }
    
    fn delete(&self, session_id: &str) -> Result<()> {
        // Delete from Redis
    }
    
    fn list(&self, limit: usize) -> Result<Vec<SessionInfo>> {
        // List sessions from Redis
    }
}
```

## SessionInfo

Brief session info for listing:

```rust
use praisonai::session::FileSessionStore;

let store = FileSessionStore::new();

// List recent sessions
let sessions = store.list(10)?;

for info in sessions {
    println!("ID: {}", info.session_id);
    println!("Agent: {:?}", info.agent_name);
    println!("Created: {}", info.created_at);
    println!("Updated: {}", info.updated_at);
    println!("Messages: {}", info.message_count);
}
```

## Example: Multi-Turn Chat

```rust
use praisonai::{Agent, Session, Result};
use std::io::{self, BufRead, Write};

#[tokio::main]
async fn main() -> Result<()> {
    // Load or create session
    let mut session = Session::new("chat-session");
    
    let agent = Agent::new()
        .name("assistant")
        .instructions("You are a helpful assistant")
        .build()?;
    
    let stdin = io::stdin();
    
    loop {
        print!("> ");
        io::stdout().flush().unwrap();
        
        let mut input = String::new();
        stdin.lock().read_line(&mut input)?;
        let input = input.trim();
        
        if input == "quit" {
            break;
        }
        
        // Add user message
        session.add_user_message(input)?;
        
        // Get response with history
        let history = session.get_history(Some(20));
        // ... pass history to agent ...
        
        let response = agent.chat(input).await?;
        
        // Add assistant response
        session.add_assistant_message(&response)?;
        
        println!("Assistant: {}", response);
    }
    
    println!("Session saved: {}", session.id());
    Ok(())
}
```

## Related

<CardGroup cols={2}>
  <Card title="Agent" icon="robot" href="/docs/rust/agent">
    Agent API reference
  </Card>
  <Card title="Memory" icon="brain" href="/docs/rust/memory">
    In-memory conversation history
  </Card>
  <Card title="Context Management" icon="layer-group" href="/docs/rust/context-management">
    Managing context
  </Card>
  <Card title="Configuration" icon="gear" href="/docs/rust/configuration">
    Session configuration
  </Card>
</CardGroup>
