---
title: "Gateway"
sidebarTitle: "Gateway"
description: "Multi-agent coordination and real-time gateway in the PraisonAI Rust SDK"
icon: "tower-broadcast"
---

# Gateway

The Gateway module provides protocols and types for control plane implementations, enabling multi-agent coordination, session management, and real-time communication.

## Quick Start

```rust
use praisonai::gateway::{GatewayEvent, EventType, GatewayMessage, GatewayConfig};

// Create an event
let event = GatewayEvent::new(EventType::Message)
    .source("agent-1")
    .target("agent-2")
    .data(serde_json::json!({"content": "Hello!"}));

// Create a message
let message = GatewayMessage::text(
    "Hello from agent",
    "agent-1",
    "session-123"
);

println!("Event: {:?}", event.event_type);
println!("Message: {:?}", message.text_content());
```

## EventType

Types of gateway events:

| Event | Description |
|-------|-------------|
| `Connect` | Client connected |
| `Disconnect` | Client disconnected |
| `AgentRegister` | Agent registered |
| `AgentUnregister` | Agent unregistered |
| `AgentStatus` | Agent status update |
| `Message` | Message event |
| `MessageAck` | Message acknowledgment |
| `Typing` | Typing indicator |
| `Health` | Health check |
| `Error` | Error occurred |
| `Broadcast` | Broadcast message |

## GatewayEvent

An event with metadata:

```rust
use praisonai::gateway::{GatewayEvent, EventType};

let event = GatewayEvent::new(EventType::AgentRegister)
    .source("my-agent")
    .target("coordinator")
    .data(serde_json::json!({
        "capabilities": ["research", "writing"],
        "model": "gpt-4"
    }));

// Access properties
println!("ID: {}", event.id);
println!("Type: {}", event.event_type);
println!("Timestamp: {}", event.timestamp);
println!("Source: {:?}", event.source);
println!("Target: {:?}", event.target);

// Serialize
let dict = event.to_dict();

// Deserialize
let restored = GatewayEvent::from_dict(&dict);
```

## GatewayMessage

A message sent through the gateway:

```rust
use praisonai::gateway::GatewayMessage;

// Text message
let msg = GatewayMessage::text(
    "Hello, world!",
    "sender-123",
    "session-456"
);

// With reply
let reply = GatewayMessage::text("Reply content", "agent", "session")
    .reply_to("original-message-id");

// With metadata
let enriched = GatewayMessage::text("Content", "agent", "session")
    .metadata("priority", serde_json::json!("high"))
    .metadata("tags", serde_json::json!(["important", "urgent"]));

// Access content
if let Some(text) = msg.text_content() {
    println!("Text: {}", text);
}

// Serialize/deserialize
let dict = msg.to_dict();
let restored = GatewayMessage::from_dict(&dict);
```

### GatewayMessage Fields

| Field | Type | Description |
|-------|------|-------------|
| `id` | String | Message ID |
| `content` | Value | Message content |
| `sender_id` | String | Sender identifier |
| `session_id` | String | Session identifier |
| `timestamp` | f64 | Unix timestamp |
| `reply_to` | Option | Reply-to message ID |
| `metadata` | HashMap | Additional metadata |

## GatewayConfig

Configuration for gateway connections:

```rust
use praisonai::gateway::GatewayConfig;

let config = GatewayConfig::new()
    .host("localhost")
    .port(8080)
    .path("/ws")
    .reconnect_enabled(true)
    .reconnect_attempts(5)
    .reconnect_delay_ms(1000)
    .heartbeat_interval_ms(30000)
    .connect_timeout_ms(10000);

println!("URL: ws://{}:{}{}", config.host, config.port, config.path);
```

### Configuration Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `host` | String | "localhost" | Host address |
| `port` | u16 | 8080 | Port number |
| `path` | String | "/ws" | WebSocket path |
| `reconnect_enabled` | bool | true | Auto-reconnect |
| `reconnect_attempts` | u32 | 5 | Max reconnect tries |
| `reconnect_delay_ms` | u64 | 1000 | Delay between retries |
| `heartbeat_interval_ms` | u64 | 30000 | Heartbeat interval |

## GatewayClient

Connect to a gateway server:

```rust
use praisonai::gateway::{GatewayClient, GatewayConfig, EventType, GatewayEvent};

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    let config = GatewayConfig::new()
        .host("example.com")
        .port(443);
    
    let client = GatewayClient::new(config);
    
    // Register event handler
    client.on_event(|event: GatewayEvent| {
        match event.event_type {
            EventType::Message => println!("Message: {:?}", event.data),
            EventType::AgentStatus => println!("Status: {:?}", event.data),
            _ => {}
        }
    });
    
    // Connect
    client.connect().await?;
    
    // Send events
    client.send(GatewayEvent::new(EventType::AgentRegister)
        .data(serde_json::json!({"name": "my-agent"}))
    ).await?;
    
    // Disconnect
    client.disconnect().await?;
    
    Ok(())
}
```

## GatewayServer

Create a gateway server:

```rust
use praisonai::gateway::{GatewayServer, GatewayConfig, EventType};

let config = GatewayConfig::new().port(9000);
let server = GatewayServer::new(config);

// Handle connections
server.on_connect(|client_id| {
    println!("Client connected: {}", client_id);
});

server.on_disconnect(|client_id| {
    println!("Client disconnected: {}", client_id);
});

// Handle events
server.on_event(EventType::Message, |event| {
    println!("Message from {}: {:?}", event.source.unwrap_or_default(), event.data);
});

// Broadcast
server.broadcast(GatewayEvent::new(EventType::Broadcast)
    .data(serde_json::json!({"announcement": "Server starting"})));
```

## Example: Multi-Agent Chat

```rust
use praisonai::gateway::{
    GatewayClient, GatewayConfig, GatewayEvent, GatewayMessage, EventType
};
use std::sync::Arc;

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    let config = GatewayConfig::new()
        .host("gateway.example.com");
    
    let client = Arc::new(GatewayClient::new(config));
    
    // Handle incoming messages
    let client_clone = client.clone();
    client.on_event(move |event| {
        if event.event_type == EventType::Message {
            if let Some(text) = event.data.get("content") {
                println!("Received: {}", text);
            }
        }
    });
    
    client.connect().await?;
    
    // Register agent
    client.send(GatewayEvent::new(EventType::AgentRegister)
        .source("research-agent")
        .data(serde_json::json!({
            "capabilities": ["research", "analysis"]
        }))
    ).await?;
    
    // Send message to another agent
    let msg = GatewayMessage::text(
        "Please analyze this topic",
        "research-agent",
        "session-123"
    );
    
    client.send(GatewayEvent::new(EventType::Message)
        .source("research-agent")
        .target("analysis-agent")
        .data(serde_json::to_value(&msg)?)
    ).await?;
    
    Ok(())
}
```

## Related

<CardGroup cols={2}>
  <Card title="Agent Team" icon="people-group" href="/docs/rust/agent-team">
    Multi-agent coordination
  </Card>
  <Card title="Sessions" icon="list-check" href="/docs/rust/sessions">
    Session management
  </Card>
  <Card title="Streaming" icon="wave-pulse" href="/docs/rust/streaming">
    Real-time streaming
  </Card>
  <Card title="Handoffs" icon="arrows-repeat" href="/docs/rust/handoffs">
    Agent handoffs
  </Card>
</CardGroup>
