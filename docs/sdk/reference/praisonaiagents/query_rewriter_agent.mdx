---
title: "query_rewriter_agent"
description: "Query Rewriter Agent Module"
icon: "robot"
---

# query_rewriter_agent

<Badge color="blue">Core SDK</Badge>

Query Rewriter Agent Module

This module provides the QueryRewriterAgent class for transforming user queries
to improve retrieval quality in RAG applications.

Supported Rewriting Strategies:
- **BASIC**: Simple rephrasing for clarity and keyword optimization
- **HYDE**: Hypothetical Document Embeddings - generates a hypothetical answer
- **STEP_BACK**: Generates higher-level concept questions for complex queries
- **SUB_QUERIES**: Decomposes multi-part questions into focused sub-queries
- **MULTI_QUERY**: Generates multiple paraphrased versions for ensemble retrieval
- **CONTEXTUAL**: Uses conversation history to resolve references and context

Example:
    from praisonaiagents import QueryRewriterAgent, RewriteStrategy
    
    agent = QueryRewriterAgent()
    
    # Basic rewriting
    result = agent.rewrite("AI trends")
    print(result.rewritten_queries)
    
    # HyDE for better semantic matching
    result = agent.rewrite("What is quantum computing?", strategy=RewriteStrategy.HYDE)
    print(result.hypothetical_document)
    
    # Contextual with chat history
    chat_history = [
        &#123;"role": "user", "content": "Tell me about Python"&#125;,
        &#123;"role": "assistant", "content": "Python is a programming language..."&#125;
    ]
    result = agent.rewrite("What about its performance?", chat_history=chat_history)
    
    # With search tools for context-aware rewriting
    from praisonaiagents.tools import internet_search
    agent = QueryRewriterAgent(tools=[internet_search])
    result = agent.rewrite("latest AI developments")  # Searches first, then rewrites

## Import

```python
from praisonaiagents import query_rewriter_agent
```

## Classes

### RewriteStrategy

*Extends: Enum*

Enumeration of available query rewriting strategies.

### RewriteResult

Result of a query rewriting operation.

<Accordion title="Properties">

| Property | Type |
|----------|------|
| `original_query` | `str` |
| `rewritten_queries` | `List` |
| `strategy_used` | `RewriteStrategy` |
| `hypothetical_document` | `Optional` |
| `step_back_question` | `Optional` |
| `sub_queries` | `Optional` |
| `metadata` | `Dict` |
</Accordion>

<Accordion title="Methods">
- **primary_query**(``) → `str`
  Returns the primary rewritten query.
- **all_queries**(``) → `List`
  Returns all queries including original and rewritten.
</Accordion>

### QueryRewriterAgent

Agent for rewriting queries to improve retrieval quality in RAG applications.

This agent transforms user queries using various strategies to bridge the gap
between how users ask questions and how information is stored in knowledge bases.

Attributes:
    name: Name of the agent
    model: LLM model to use for rewriting (alias for llm=)
    max_queries: Maximum number of queries to generate for multi-query strategy
    abbreviations: Dictionary of common abbreviations to expand
    
Example:
    agent = QueryRewriterAgent(model="gpt-4o-mini")
    result = agent.rewrite("ML best practices", strategy=RewriteStrategy.MULTI_QUERY)
    for query in result.rewritten_queries:
        print(query)

<Accordion title="Constructor Parameters">

| Parameter | Type | Required | Default |
|-----------|------|----------|---------|
| `name` | `str` | No | `QueryRewriterAgent` |
| `model` | `str` | No | `'gpt-4o-mini'` |
| `instructions` | `Optional` | No | `None` |
| `verbose` | `bool` | No | `False` |
| `max_queries` | `int` | No | `5` |
| `abbreviations` | `Optional` | No | `None` |
| `temperature` | `float` | No | `0.3` |
| `max_tokens` | `int` | No | `500` |
| `tools` | `Optional` | No | `None` |
</Accordion>

<Accordion title="Methods">
- **agent**(``) → `Any`
  Lazy initialization of internal Agent.
- **rewrite**(`query: str, strategy: RewriteStrategy, chat_history: Optional`) → `RewriteResult`
  Rewrite a query using the specified strategy.

All operations go through an inte
- **rewrite_basic**(`query: str`) → `RewriteResult`
  Convenience method for basic rewriting.
- **rewrite_hyde**(`query: str`) → `RewriteResult`
  Convenience method for HyDE rewriting.
- **rewrite_step_back**(`query: str`) → `RewriteResult`
  Convenience method for step-back rewriting.
- **rewrite_sub_queries**(`query: str`) → `RewriteResult`
  Convenience method for sub-query decomposition.
- **rewrite_multi_query**(`query: str, num_queries: int`) → `RewriteResult`
  Convenience method for multi-query generation.
- **rewrite_contextual**(`query: str, chat_history: List`) → `RewriteResult`
  Convenience method for contextual rewriting.
- **add_abbreviation**(`abbrev: str, expansion: str`) → `None`
  Add a custom abbreviation expansion.
- **add_abbreviations**(`abbreviations: Dict`) → `None`
  Add multiple custom abbreviation expansions.
</Accordion>
