---
title: 'WorkflowManager API'
description: 'API reference for WorkflowManager, Workflow, and WorkflowStep classes'
icon: "diagram-project"
---

# WorkflowManager API

The `WorkflowManager` class manages workflow discovery, loading, and execution from markdown files.

## Import

```python
from praisonaiagents.memory import WorkflowManager, Workflow, WorkflowStep
```

## WorkflowStep

A dataclass representing a single step in a workflow.

### Constructor

```python
WorkflowStep(
    name: str,
    description: str = "",
    action: str = "",
    condition: Optional[str] = None,
    on_error: Literal["stop", "continue", "retry"] = "stop",
    max_retries: int = 1,
    context_from: Optional[List[str]] = None,
    retain_full_context: bool = True,
    output_variable: Optional[str] = None,
    agent_config: Optional[Dict[str, Any]] = None,
    tools: Optional[List[Any]] = None
)
```

### Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `name` | `str` | required | Step name |
| `description` | `str` | `""` | Step description |
| `action` | `str` | `""` | The action/prompt to execute |
| `condition` | `Optional[str]` | `None` | Condition for execution |
| `on_error` | `Literal["stop", "continue", "retry"]` | `"stop"` | Error handling mode |
| `max_retries` | `int` | `1` | Maximum retry attempts |
| `context_from` | `Optional[List[str]]` | `None` | Steps to include context from |
| `retain_full_context` | `bool` | `True` | Include all previous outputs |
| `output_variable` | `Optional[str]` | `None` | Custom variable name for output |
| `agent_config` | `Optional[Dict[str, Any]]` | `None` | Per-step agent configuration |
| `tools` | `Optional[List[Any]]` | `None` | Tools for this step |

### Agent Config Options

When using `agent_config`, you can specify:

| Key | Type | Description |
|-----|------|-------------|
| `role` | `str` | Agent role (e.g., "Researcher") |
| `goal` | `str` | Agent goal |
| `backstory` | `str` | Agent backstory |
| `llm` | `str` | LLM model override |
| `verbose` | `bool` | Enable verbose output |

### Example

```python
step = WorkflowStep(
    name="research",
    action="Research {{topic}}",
    agent_config={
        "role": "Researcher",
        "goal": "Find comprehensive information",
        "backstory": "Expert researcher"
    },
    tools=["tavily_search"],
    output_variable="research_data"
)
```

---

## Workflow

A dataclass representing a complete workflow with multiple steps.

### Constructor

```python
Workflow(
    name: str,
    description: str = "",
    steps: List[WorkflowStep] = [],
    variables: Dict[str, Any] = {},
    file_path: Optional[str] = None,
    default_agent_config: Optional[Dict[str, Any]] = None,
    default_llm: Optional[str] = None,
    memory_config: Optional[Dict[str, Any]] = None,
    planning: bool = False,
    planning_llm: Optional[str] = None
)
```

### Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `name` | `str` | required | Workflow name |
| `description` | `str` | `""` | Workflow description |
| `steps` | `List[WorkflowStep]` | `[]` | List of workflow steps |
| `variables` | `Dict[str, Any]` | `{}` | Default variables |
| `file_path` | `Optional[str]` | `None` | Source file path |
| `default_agent_config` | `Optional[Dict[str, Any]]` | `None` | Default agent config for all steps |
| `default_llm` | `Optional[str]` | `None` | Default LLM model |
| `memory_config` | `Optional[Dict[str, Any]]` | `None` | Memory configuration |
| `planning` | `bool` | `False` | Enable planning mode |
| `planning_llm` | `Optional[str]` | `None` | LLM for planning |

### Example

```python
workflow = Workflow(
    name="research_pipeline",
    description="Multi-agent research workflow",
    default_llm="gpt-4o-mini",
    planning=True,
    steps=[
        WorkflowStep(name="research", action="Research AI"),
        WorkflowStep(name="write", action="Write report")
    ],
    variables={"topic": "AI trends"}
)
```

---

## WorkflowManager

The main class for managing and executing workflows.

### Constructor

```python
WorkflowManager(
    workspace_path: Optional[str] = None,
    verbose: int = 0
)
```

### Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `workspace_path` | `Optional[str]` | `None` | Path to workspace (defaults to cwd) |
| `verbose` | `int` | `0` | Verbosity level (0-3) |

---

## Methods

### execute()

Execute a workflow synchronously.

```python
def execute(
    workflow_name: str,
    executor: Optional[Callable[[str], str]] = None,
    variables: Optional[Dict[str, Any]] = None,
    on_step: Optional[Callable[[WorkflowStep, int], None]] = None,
    on_result: Optional[Callable[[WorkflowStep, str], None]] = None,
    default_agent: Optional[Any] = None,
    default_llm: Optional[str] = None,
    memory: Optional[Any] = None,
    planning: bool = False,
    stream: bool = False,
    verbose: int = 0
) -> Dict[str, Any]
```

#### Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `workflow_name` | `str` | required | Name of workflow to execute |
| `executor` | `Optional[Callable]` | `None` | Function to execute each step |
| `variables` | `Optional[Dict]` | `None` | Variables to substitute |
| `on_step` | `Optional[Callable]` | `None` | Callback before each step |
| `on_result` | `Optional[Callable]` | `None` | Callback after each step |
| `default_agent` | `Optional[Any]` | `None` | Default agent for steps |
| `default_llm` | `Optional[str]` | `None` | Default LLM model |
| `memory` | `Optional[Any]` | `None` | Shared memory instance |
| `planning` | `bool` | `False` | Enable planning mode |
| `stream` | `bool` | `False` | Enable streaming output |
| `verbose` | `int` | `0` | Verbosity level |

#### Returns

```python
{
    "success": bool,
    "workflow": str,
    "results": [
        {
            "step": str,
            "status": "success" | "failed" | "skipped",
            "output": str | None,
            "error": str | None
        }
    ],
    "variables": Dict[str, Any]
}
```

#### Example

```python
from praisonaiagents import Agent
from praisonaiagents.memory import WorkflowManager

agent = Agent(name="Assistant", llm="gpt-4o-mini")
manager = WorkflowManager()

result = manager.execute(
    "deploy",
    default_agent=agent,
    variables={"environment": "production"},
    on_step=lambda step, i: print(f"Starting: {step.name}"),
    on_result=lambda step, output: print(f"Done: {step.name}")
)

if result["success"]:
    print("Workflow completed!")
```

---

### aexecute()

Execute a workflow asynchronously.

```python
async def aexecute(
    workflow_name: str,
    executor: Optional[Callable[[str], str]] = None,
    variables: Optional[Dict[str, Any]] = None,
    on_step: Optional[Callable[[WorkflowStep, int], None]] = None,
    on_result: Optional[Callable[[WorkflowStep, str], None]] = None,
    default_agent: Optional[Any] = None,
    default_llm: Optional[str] = None,
    memory: Optional[Any] = None,
    planning: bool = False,
    stream: bool = False,
    verbose: int = 0
) -> Dict[str, Any]
```

#### Parameters

Same as `execute()`.

#### Example

```python
import asyncio
from praisonaiagents.memory import WorkflowManager

manager = WorkflowManager()

async def main():
    # Run multiple workflows concurrently
    results = await asyncio.gather(
        manager.aexecute("research", default_llm="gpt-4o-mini"),
        manager.aexecute("analysis", default_llm="gpt-4o-mini"),
    )
    return results

results = asyncio.run(main())
```

---

### list_workflows()

List all available workflows.

```python
def list_workflows() -> List[Workflow]
```

#### Returns

List of `Workflow` objects.

#### Example

```python
manager = WorkflowManager()
workflows = manager.list_workflows()

for workflow in workflows:
    print(f"{workflow.name}: {len(workflow.steps)} steps")
```

---

### get_workflow()

Get a specific workflow by name.

```python
def get_workflow(name: str) -> Optional[Workflow]
```

#### Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `name` | `str` | Workflow name (case-insensitive) |

#### Returns

`Workflow` object or `None` if not found.

---

### create_workflow()

Create a new workflow file.

```python
def create_workflow(
    name: str,
    description: str = "",
    steps: Optional[List[Dict[str, str]]] = None,
    variables: Optional[Dict[str, Any]] = None
) -> Workflow
```

#### Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `name` | `str` | required | Workflow name |
| `description` | `str` | `""` | Workflow description |
| `steps` | `Optional[List[Dict]]` | `None` | List of step definitions |
| `variables` | `Optional[Dict]` | `None` | Default variables |

#### Example

```python
manager = WorkflowManager()

workflow = manager.create_workflow(
    name="Code Review",
    description="Review code changes",
    steps=[
        {"name": "Lint", "action": "Run linting"},
        {"name": "Test", "action": "Run tests"},
        {"name": "Review", "action": "Review code"}
    ],
    variables={"branch": "main"}
)
```

---

### get_stats()

Get workflow statistics.

```python
def get_stats() -> Dict[str, Any]
```

#### Returns

```python
{
    "total_workflows": int,
    "total_steps": int,
    "workflows_dir": str
}
```

---

### reload()

Reload workflows from disk.

```python
def reload() -> None
```

---

## Variable Substitution

Workflows support variable substitution using `{{variable}}` syntax:

| Variable | Description |
|----------|-------------|
| `{{variable_name}}` | User-defined variable |
| `{{previous_output}}` | Output from previous step |
| `{{step_name_output}}` | Output from specific step |

### Example

```python
workflow = Workflow(
    name="pipeline",
    variables={"topic": "AI"},
    steps=[
        WorkflowStep(
            name="research",
            action="Research {{topic}}",
            output_variable="research_data"
        ),
        WorkflowStep(
            name="analyze",
            action="Analyze: {{research_data}}"
        ),
        WorkflowStep(
            name="write",
            action="Write about {{previous_output}}"
        )
    ]
)
```

---

## See Also

<CardGroup cols={2}>
  <Card title="Workflows Guide" icon="diagram-project" href="/features/workflows">
    Complete workflows documentation
  </Card>
  <Card title="Agent API" icon="robot" href="/api-reference/agent">
    Agent class reference
  </Card>
</CardGroup>
