---
title: "Graph RAG"
description: "Graph-based Retrieval Augmented Generation"
icon: "diagram-project"
---

# Graph RAG

Graph RAG combines knowledge graphs with vector similarity for enhanced retrieval that captures relationships between documents.

## Quick Start

```typescript
import { createGraphRAG } from 'praisonai';

const graphRag = createGraphRAG({
  embedFn: async (text) => {
    // Your embedding function
    return await getEmbedding(text);
  }
});

// Add documents
await graphRag.addDocument({
  id: 'doc-1',
  content: 'TypeScript is a typed superset of JavaScript',
  type: 'concept'
});

await graphRag.addDocument({
  id: 'doc-2', 
  content: 'JavaScript is a programming language for the web',
  type: 'concept'
});

// Add relationships
graphRag.addRelationship('doc-1', 'doc-2', 'extends', 0.9);

// Query
const results = await graphRag.query('What is TypeScript?');
console.log(graphRag.getContext(results));
```

## Graph Store

The underlying graph store supports nodes and edges:

```typescript
import { GraphStore } from 'praisonai';

const graph = new GraphStore();

// Add nodes
graph.addNode({
  id: 'node-1',
  type: 'document',
  content: 'Content here',
  metadata: { source: 'file.pdf' }
});

// Add edges
graph.addEdge({
  id: 'edge-1',
  source: 'node-1',
  target: 'node-2',
  type: 'references',
  weight: 0.8
});

// Get neighbors
const neighbors = graph.getNeighbors('node-1', 'both');

// Find paths
const paths = graph.findPaths('node-1', 'node-5', 3);

// Get subgraph
const subgraph = graph.getSubgraph('node-1', 2);
```

## Building Knowledge Graphs

### From Documents

```typescript
import { createGraphRAG, Chunking } from 'praisonai';

const graphRag = createGraphRAG({ embedFn });
const chunker = new Chunking({ strategy: 'sentence', maxSize: 500 });

// Process document
const chunks = chunker.chunk(documentContent);

// Add chunks as nodes
for (let i = 0; i < chunks.length; i++) {
  await graphRag.addDocument({
    id: `chunk-${i}`,
    content: chunks[i].content,
    type: 'chunk',
    metadata: { index: i, source: 'document.pdf' }
  });

  // Link sequential chunks
  if (i > 0) {
    graphRag.addRelationship(`chunk-${i-1}`, `chunk-${i}`, 'next');
  }
}
```

### Entity Extraction

```typescript
import { Agent, createGraphRAG } from 'praisonai';

const extractor = new Agent({
  name: 'Entity Extractor',
  instructions: `Extract entities and relationships from text.
Return JSON: { entities: [{id, type, name}], relationships: [{source, target, type}] }`
});

async function buildGraphFromText(text: string) {
  const graphRag = createGraphRAG({ embedFn });
  
  // Extract entities
  const extraction = await extractor.chat(text);
  const { entities, relationships } = JSON.parse(extraction);
  
  // Add entities as nodes
  for (const entity of entities) {
    await graphRag.addDocument({
      id: entity.id,
      content: entity.name,
      type: entity.type
    });
  }
  
  // Add relationships
  for (const rel of relationships) {
    graphRag.addRelationship(rel.source, rel.target, rel.type);
  }
  
  return graphRag;
}
```

## Querying

### Basic Query

```typescript
const results = await graphRag.query('How does TypeScript relate to JavaScript?', {
  maxDepth: 2,
  maxNodes: 10,
  minScore: 0.3,
  includeEdges: true
});

console.log('Nodes:', results.nodes.length);
console.log('Edges:', results.edges.length);
console.log('Paths:', results.paths.length);
console.log('Score:', results.score);
```

### Get Context for LLM

```typescript
const context = graphRag.getContext(results);
// Returns formatted string of all node contents

const agent = new Agent({
  name: 'Assistant',
  instructions: 'Answer based on the provided context.'
});

const answer = await agent.chat(`Context:\n${context}\n\nQuestion: ${query}`);
```

## Configuration

```typescript
interface GraphRAGConfig {
  maxDepth?: number;    // Max graph traversal depth (default: 2)
  maxNodes?: number;    // Max nodes to return (default: 10)
  minScore?: number;    // Min similarity score (default: 0)
  includeEdges?: boolean; // Include edges in results (default: true)
}
```

## Graph Statistics

```typescript
const stats = graphRag.getGraphStore().getStats();
console.log(`Nodes: ${stats.nodeCount}, Edges: ${stats.edgeCount}`);
```

## Use Cases

1. **Document Q&A** - Navigate related documents
2. **Knowledge Bases** - Entity-relationship queries
3. **Code Analysis** - Function/class dependencies
4. **Research** - Citation networks

## Related

- [Knowledge Base](/docs/js/knowledge-base) - Vector-based RAG
- [Reranking](/docs/js/reranking) - Improve relevance
- [Chunking](/docs/js/chunking) - Document chunking
