---
title: "Reranking"
description: "Improve search relevance with reranking models"
icon: "arrow-up-right-dots"
---

# Reranking

Reranking improves search results by re-scoring documents based on their relevance to the query.

## Supported Rerankers

| Reranker | Description | API Required |
|----------|-------------|--------------|
| **Cohere** | Production-grade reranking | Yes |
| **CrossEncoder** | Embedding-based | No |
| **LLM** | LLM-as-judge | Yes |

## Quick Start

```typescript
import { 
  createCohereReranker,
  createCrossEncoderReranker,
  createLLMReranker
} from 'praisonai';

// Cohere Reranker (recommended for production)
const cohere = createCohereReranker({
  apiKey: process.env.COHERE_API_KEY
});

// Cross-Encoder Reranker (with custom embeddings)
const crossEncoder = createCrossEncoderReranker({
  embedFn: async (texts) => {
    // Your embedding function
    return await getEmbeddings(texts);
  }
});

// LLM Reranker (uses LLM to score relevance)
const llmReranker = createLLMReranker({
  generateFn: async (prompt) => {
    // Your LLM function
    return await generateText(prompt);
  }
});
```

## Basic Usage

```typescript
const documents = [
  { id: 'doc-1', content: 'TypeScript is a typed superset of JavaScript' },
  { id: 'doc-2', content: 'Python is a popular programming language' },
  { id: 'doc-3', content: 'JavaScript runs in the browser' }
];

const results = await reranker.rerank(
  'What is TypeScript?',
  documents,
  { topK: 2, threshold: 0.5 }
);

for (const result of results) {
  console.log(`${result.newRank}. [${result.score.toFixed(2)}] ${result.content}`);
}
// Output:
// 1. [0.95] TypeScript is a typed superset of JavaScript
// 2. [0.72] JavaScript runs in the browser
```

## Cohere Reranker

Best for production use with high accuracy:

```typescript
import { createCohereReranker } from 'praisonai';

const reranker = createCohereReranker({
  apiKey: process.env.COHERE_API_KEY,
  model: 'rerank-english-v3.0'  // or 'rerank-multilingual-v3.0'
});

const results = await reranker.rerank(query, documents, {
  topK: 5,
  threshold: 0.3
});
```

## Cross-Encoder Reranker

Uses embeddings for similarity scoring:

```typescript
import { createCrossEncoderReranker } from 'praisonai';

const reranker = createCrossEncoderReranker({
  embedFn: async (texts: string[]) => {
    // Batch embed all texts
    const embeddings = await Promise.all(
      texts.map(text => getEmbedding(text))
    );
    return embeddings;
  }
});

// Falls back to keyword matching if no embedFn provided
const simpleReranker = createCrossEncoderReranker();
```

## LLM Reranker

Uses an LLM to score relevance (slower but flexible):

```typescript
import { createLLMReranker } from 'praisonai';
import { Agent } from 'praisonai';

const agent = new Agent({ name: 'Scorer' });

const reranker = createLLMReranker({
  generateFn: async (prompt) => {
    return await agent.chat(prompt);
  }
});

const results = await reranker.rerank(query, documents);
```

## With RAG Pipeline

```typescript
import { KnowledgeBase, createCohereReranker } from 'praisonai';

const kb = new KnowledgeBase({ /* config */ });
const reranker = createCohereReranker({ apiKey: process.env.COHERE_API_KEY });

async function ragWithReranking(query: string) {
  // 1. Initial retrieval (fast, broad)
  const initialResults = await kb.search(query, { topK: 20 });
  
  // 2. Rerank for precision
  const reranked = await reranker.rerank(
    query,
    initialResults.map(r => ({ id: r.id, content: r.content, metadata: r.metadata })),
    { topK: 5 }
  );
  
  // 3. Use top results for context
  const context = reranked.map(r => r.content).join('\n\n');
  return context;
}
```

## Configuration Options

```typescript
interface RerankConfig {
  topK?: number;      // Max results to return
  threshold?: number; // Min score threshold (0-1)
  model?: string;     // Model name (Cohere only)
}
```

## Result Structure

```typescript
interface RerankResult {
  id: string;           // Document ID
  score: number;        // Relevance score (0-1)
  content: string;      // Document content
  metadata?: object;    // Original metadata
  originalRank: number; // Position before reranking
  newRank: number;      // Position after reranking
}
```

## CLI Usage

```bash
# Rerank search results
npx praisonai rerank "query" --documents docs.json --topK 5

# With specific reranker
npx praisonai rerank "query" --reranker cohere --model rerank-english-v3.0
```

## Environment Variables

```bash
COHERE_API_KEY=your-cohere-api-key
```

## Related

- [Knowledge Base](/docs/js/knowledge-base) - RAG implementation
- [Vector Stores](/docs/js/vector-stores) - Vector database integrations
- [Graph RAG](/docs/js/graph-rag) - Graph-based retrieval
